name: AI Evaluation

on:
  workflow_dispatch:
    inputs:
      answer:
        description: "إجابة المستخدم للتمرين"
        required: true

jobs:
  evaluate:
    runs-on: ubuntu-latest

    steps:
      - name: Call DeepSeek AI
        env:
          API_key: ${{ secrets.API_key }}
        run: |
          echo "جارٍ تحليل الإجابة..."
          curl -s https://api.deepseek.com/chat/completions \
          -H "Authorization: Bearer $API_key" \
          -H "Content-Type: application/json" \
          -d '{
            "model":"deepseek-chat",
            "messages":[
              {"role":"system","content":"أنت مقيّم صارم. لا مجاملات. قيّم الإجابة بدقة وامنح درجة من 100، نقاط القوة والضعف، ونموذج الإجابة المثالي."},
              {"role":"user","content":"قيم هذه الإجابة:\n${{ github.event.inputs.answer }}"}
            ]
          }' > result.json

      - name: عرض التقييم
        run: |
          echo "=== التقييم الناتج ==="
          cat result.json
